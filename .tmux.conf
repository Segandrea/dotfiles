# Terminology:
# - A window is like a workspace of gnome/kde/ecc. but inside a terminal.
# - A pane is a split of a window(workspace).
# - In the keybindings M- stands for "meta" + another char (that is "alt" + another char)
# - In the keybindings C- stands for "ctrl" + another char
#       (so C-M-k for example is "ctrl" + "alt" + 'k' pressed together)
# - Syntax:
#   1) "set" is an alias for "set-option" and is used to set options.
#       1.1) the "prefix" is a keystroke that is to be typed before the real keystroke.
#   2) "bind" is an alias for "bind-key" and is used to bind a keystroke to an action.
#       2.1) "bind" with "-n" option means that you can avoid to press the prefix before the keystroke.
#   3) "unbind" is used to unbind a keystroke from an action

# settings to work with terminal
set -g default-terminal "tmux-256color"

# Usually tmux commands are prefix followed by some other key bindings (it's not pressed together).
# But i will probably use a lot of shortcuts without prefix to make it faster.
# remap the prefix from 'ctrl+b' to 'alt+a'
set-option -g prefix M-a
bind-key M-a send-prefix

# key to reload the configuration
# here I didn't specify the -n option to bind, that means I have to press prefix, release it and then r
bind r source-file ~/.tmux.conf

# mouse controls (may mess text selection but allows click to select pane)
set -g mouse on

# Window(workspaces) commands:
# create a new window(workspace)
bind -n M-t new-window
# go to next window(workspace)
bind -n M-n next-window
# go to previous window(workspace)
bind -n M-N previous-window
# Renumber windows sequentially after closing one of them
set -g renumber-windows on

# Splits-related commands:
# remap the splitting to 'prefix+h' and 'prefix+v'
# split vertically
bind -n M-v split-window -h -c "#{pane_current_path}"
# split horizontally
unbind %
bind -n M-o split-window -v -c "#{pane_current_path}"
# close a pane
bind -n M-q kill-pane
# fast switch of pane (no prefix)
# go left one pane
bind -n M-h select-pane -L
bind -n M-Left select-pane -L
# go right one pane
bind -n M-l select-pane -R
bind -n M-Right select-pane -R
# go up one pane
bind -n M-k select-pane -U
bind -n M-Up select-pane -U
# go down one pane
bind -n M-j select-pane -D
bind -n M-Down select-pane -D
# fast resizing of pane
# resize pane to left
bind -n M-H resize-pane -L
bind -n S-M-Left resize-pane -L
# resize pane to right
bind -n M-L resize-pane -R
bind -n S-M-Right resize-pane -R
# resize pane upward
bind -n M-K resize-pane -U
bind -n S-M-Up resize-pane -U
# resize pane downward
bind -n M-J resize-pane -D
bind -n S-M-Down resize-pane -D
# toggle full-screen for the current pane
bind -n M-m resize-pane -Z
# scrolling pane ('copy-mode' is repeated every time but I'm lazy and this works)
# enter copy-mode and scroll-up
bind -n C-M-Up copy-mode \; send-keys -X scroll-up
bind -n C-M-K copy-mode \; send-keys -X scroll-up
# enter copy-mode and scroll-down
bind -n C-M-Down copy-mode \; send-keys -X scroll-down
bind -n C-M-J copy-mode \; send-keys -X scroll-down

# the power of vim in selecting, copying and pasting out of vim
set-window-option -g mode-keys vi
# paste from buffer
bind -n M-p paste-buffer
# shortcut to enter copy-mode
bind -n M-c copy-mode
# (in copy-mode) 'v' to select:
bind-key -T copy-mode-vi v send-keys -X begin-selection
# (in copy-mode) 'y' to yank:
bind-key -T copy-mode-vi y send-keys -X copy-selection
# (in copy-mode) 'r' to select multiple line:
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
# (in copy-mode) 'q' to quit copy-mode:
bind-key -T copy-mode-vi q send-keys -X cancel
bind-key -T copy-mode-vi Escape send-keys -X cancel
# NB. typing 'prefix+:' and then
# 'list-keys -T copy-mode-vi' shows a list of vi-like functionalities

###########
# PLUGINS #
###########
# exemples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin_name'
# set -g @plugin 'git@bitbucket.com:user/plugin_name'

# NB. shortcuts for the plugin manager:
# * 'prefix and then 'I'(capital i)': install
# * 'prefix and then 'U'(capital u)': update plugins
# * 'prefix and then 'Alt+u'': remove plugins that are no more in the list

# START - List of plugins - START
# tpm (tmux plugin manager)
set -g @tpm_plugins '           \
    tmux-plugins/tpm            \
    tmux-plugins/tmux-sensible  \
    tmux-plugins/tmux-yank      \
    dracula/tmux                \
'
# END - List of plugins - END

# Tmux plugin manager settings
set-environment -g TMUX_PLUGIN_MANAGER_PATH '~/.tmux/plugins/'

# dracula theme configurations
# select the dracula-plugins to enable (bar follow the order of definition)
set -g @dracula-plugins "battery time"
# enable powerline symbols
set -g @dracula-show-powerline true
# disable window flags
set -g @dracula-show-flags false
# adjust refresh rate for status bar
set -g @dracula-refresh-rate 5
# switch the left icon (values can be 'session', 'smiley', 'window' or any char)
set -g @dracula-show-left-icon session
# add padding to the left icon
set -g @dracula-left-icon-padding 0
# high contrast pane border
set -g @dracula-border-contrast false
# enable timezone
set -g @dracula-show-timezone false
# swap date to day/month
set -g @dracula-day-month true
# enable military time
set -g @dracula-military-time true

# Init tmux plugin manager (This MUST be the last line of the file)
run -b '~/.tmux/plugins/tpm/tpm'
